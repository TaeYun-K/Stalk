---
globs: "Stalk_FE/**/*"
description: "ì„±ëŠ¥ ìµœì í™” ë° ë°°í¬ ê´€ë ¨ ê·œì¹™"
---

# âš¡ ì„±ëŠ¥ ìµœì í™” ë° ë°°í¬ ê·œì¹™

## ğŸš€ ì„±ëŠ¥ ìµœì í™” í•„ìˆ˜ ì‚¬í•­

### ì´ë¯¸ì§€ ìµœì í™”
```typescript
// âœ… ì´ë¯¸ì§€ ìµœì í™” íŒ¨í„´
const ProfileImage: React.FC<{ src: string; alt: string }> = ({ src, alt }) => {
  return (
    <img
      src={src}
      alt={alt}
      loading="lazy"                    // ì§€ì—° ë¡œë”©
      decoding="async"                  // ë¹„ë™ê¸° ë””ì½”ë”©
      className="w-20 h-20 object-cover rounded-full"
      onError={(e) => {                 // ì—ëŸ¬ ì²˜ë¦¬
        e.currentTarget.src = '/images/default-profile.svg';
      }}
    />
  );
};

// âœ… ì´ë¯¸ì§€ ì‚¬ì „ ë¡œë”©
const preloadImage = (src: string): Promise<void> => {
  return new Promise((resolve, reject) => {
    const img = new Image();
    img.onload = () => resolve();
    img.onerror = reject;
    img.src = src;
  });
};
```

### ì»´í¬ë„ŒíŠ¸ ë©”ëª¨ì´ì œì´ì…˜
```typescript
// âœ… React.memo ì ì ˆí•œ ì‚¬ìš©
interface UserCardProps {
  user: User;
  onEdit: (id: string) => void;
}

const UserCard = React.memo<UserCardProps>(({ user, onEdit }) => {
  const handleEdit = useCallback(() => {
    onEdit(user.id);
  }, [user.id, onEdit]);

  return (
    <div className="p-4 border rounded">
      <h3>{user.name}</h3>
      <button onClick={handleEdit}>í¸ì§‘</button>
    </div>
  );
});

// âœ… ë¹„êµ í•¨ìˆ˜ ì‚¬ìš© (í•„ìš”í•œ ê²½ìš°ì—ë§Œ)
const ExpensiveComponent = React.memo(
  ({ data, config }: Props) => {
    // ë³µì¡í•œ ë Œë”ë§ ë¡œì§
  },
  (prevProps, nextProps) => {
    return (
      prevProps.data.id === nextProps.data.id &&
      prevProps.config.mode === nextProps.config.mode
    );
  }
);
```

### ìƒíƒœ ìµœì í™”
```typescript
// âœ… ìƒíƒœ ë¶„ë¦¬ë¡œ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€
const UserDashboard: React.FC = () => {
  // ì„œë¡œ ë…ë¦½ì ì¸ ìƒíƒœë“¤ì€ ë¶„ë¦¬
  const [userInfo, setUserInfo] = useState<User | null>(null);
  const [notifications, setNotifications] = useState<Notification[]>([]);
  const [sidebarOpen, setSidebarOpen] = useState(false);

  // âŒ í”¼í•´ì•¼ í•  íŒ¨í„´: ëª¨ë“  ìƒíƒœë¥¼ í•˜ë‚˜ì˜ ê°ì²´ë¡œ
  // const [state, setState] = useState({
  //   userInfo: null,
  //   notifications: [],
  //   sidebarOpen: false
  // });
};

// âœ… useMemo ì ì ˆí•œ ì‚¬ìš©
const ExpensiveCalculation: React.FC<{ data: number[] }> = ({ data }) => {
  const sortedData = useMemo(() => {
    console.log('Sorting data...'); // ì‹¤ì œë¡œëŠ” ë³µì¡í•œ ê³„ì‚°
    return [...data].sort((a, b) => b - a);
  }, [data]);

  return (
    <ul>
      {sortedData.map((item, index) => (
        <li key={index}>{item}</li>
      ))}
    </ul>
  );
};
```

## ğŸ“¦ ë²ˆë“¤ ìµœì í™”

### ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…
```typescript
// âœ… ë¼ìš°íŠ¸ ê¸°ë°˜ ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…
import { lazy, Suspense } from 'react';
import { Routes, Route } from 'react-router-dom';

// ì§€ì—° ë¡œë”©ë˜ëŠ” í˜ì´ì§€ë“¤
const HomePage = lazy(() => import('@/pages/home-page'));
const ExpertDetailPage = lazy(() => import('@/pages/expert-detail-page'));
const CommunityPage = lazy(() => import('@/pages/community-page'));

const App: React.FC = () => {
  return (
    <Suspense fallback={<div>ë¡œë”© ì¤‘...</div>}>
      <Routes>
        <Route path="/" element={<HomePage />} />
        <Route path="/expert/:id" element={<ExpertDetailPage />} />
        <Route path="/community" element={<CommunityPage />} />
      </Routes>
    </Suspense>
  );
};

// âœ… ì»´í¬ë„ŒíŠ¸ ê¸°ë°˜ ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…
const HeavyChart = lazy(() => 
  import('@/components/chart/stock-chart').then(module => ({
    default: module.StockChart
  }))
);
```

### ë¼ì´ë¸ŒëŸ¬ë¦¬ ìµœì í™”
```typescript
// âœ… í•„ìš”í•œ ë¶€ë¶„ë§Œ import
import { format, parseISO } from 'date-fns';  // âœ… íŠ¹ì • í•¨ìˆ˜ë§Œ
// import * as dateFns from 'date-fns';       // âŒ ì „ì²´ ë¼ì´ë¸ŒëŸ¬ë¦¬

// âœ… Tree shaking ì§€ì› ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
import { Button } from '@/components/ui';      // âœ… 
// import * as UI from '@/components/ui';      // âŒ ì „ì²´ import
```

## ğŸ”„ ë°ì´í„° ë¡œë”© ìµœì í™”

### ë¬´í•œ ìŠ¤í¬ë¡¤
```typescript
const useInfiniteScroll = <T>(
  fetchFn: (page: number) => Promise<T[]>,
  pageSize = 10
) => {
  const [data, setData] = useState<T[]>([]);
  const [loading, setLoading] = useState(false);
  const [hasMore, setHasMore] = useState(true);
  const [page, setPage] = useState(0);

  const loadMore = useCallback(async () => {
    if (loading || !hasMore) return;

    setLoading(true);
    try {
      const newData = await fetchFn(page);
      if (newData.length < pageSize) {
        setHasMore(false);
      }
      setData(prev => [...prev, ...newData]);
      setPage(prev => prev + 1);
    } catch (error) {
      console.error('Failed to load more data:', error);
    } finally {
      setLoading(false);
    }
  }, [fetchFn, page, loading, hasMore, pageSize]);

  return { data, loading, hasMore, loadMore };
};
```

### ìºì‹± ì „ëµ
```typescript
// âœ… ê°„ë‹¨í•œ ë©”ëª¨ë¦¬ ìºì‹œ
class ApiCache {
  private cache = new Map<string, { data: any; timestamp: number }>();
  private readonly TTL = 5 * 60 * 1000; // 5ë¶„

  set(key: string, data: any): void {
    this.cache.set(key, { data, timestamp: Date.now() });
  }

  get(key: string): any | null {
    const cached = this.cache.get(key);
    if (!cached) return null;

    if (Date.now() - cached.timestamp > this.TTL) {
      this.cache.delete(key);
      return null;
    }

    return cached.data;
  }

  clear(): void {
    this.cache.clear();
  }
}

export const apiCache = new ApiCache();
```

## ğŸ› ï¸ ë¹Œë“œ ë° ë°°í¬ ì„¤ì •

### Vite ì„¤ì • ìµœì í™”
```typescript
// vite.config.ts ìµœì í™” ì˜ˆì‹œ
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import { resolve } from 'path';

export default defineConfig({
  plugins: [react()],
  
  // ê²½ë¡œ ë³„ì¹­
  resolve: {
    alias: {
      '@': resolve(__dirname, 'src'),
    },
  },

  // ë¹Œë“œ ìµœì í™”
  build: {
    // ì²­í¬ í¬ê¸° ê²½ê³  ì„ê³„ê°’
    chunkSizeWarningLimit: 1000,
    
    // ë¡¤ì—… ì˜µì…˜
    rollupOptions: {
      output: {
        // ì²­í¬ ë¶„í•  ì „ëµ
        manualChunks: {
          'react-vendor': ['react', 'react-dom'],
          'router-vendor': ['react-router-dom'],
          'chart-vendor': ['chart.js', 'react-chartjs-2'],
        },
      },
    },
  },

  // ì„œë²„ ì„¤ì •
  server: {
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://localhost:8081',
        changeOrigin: true,
      },
    },
  },
});
```

### í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬
```typescript
// âœ… í™˜ê²½ ë³€ìˆ˜ íƒ€ì… ì •ì˜
interface ImportMetaEnv {
  readonly VITE_API_URL: string;
  readonly VITE_OPENVIDU_URL: string;
  readonly VITE_ENV: 'development' | 'production';
}

interface ImportMeta {
  readonly env: ImportMetaEnv;
}

// âœ… í™˜ê²½ë³„ ì„¤ì •
const config = {
  apiUrl: import.meta.env.VITE_API_URL,
  openViduUrl: import.meta.env.VITE_OPENVIDU_URL,
  isDevelopment: import.meta.env.VITE_ENV === 'development',
  isProduction: import.meta.env.VITE_ENV === 'production',
};

// âœ… í™˜ê²½ ë³€ìˆ˜ ê²€ì¦
const validateEnv = () => {
  const required = ['VITE_API_URL', 'VITE_OPENVIDU_URL'];
  const missing = required.filter(key => !import.meta.env[key]);
  
  if (missing.length > 0) {
    throw new Error(`Missing required environment variables: ${missing.join(', ')}`);
  }
};
```

## ğŸ› ë””ë²„ê¹… ë° ê°œë°œ ë„êµ¬

### ê°œë°œ í™˜ê²½ ë””ë²„ê¹…
```typescript
// âœ… ê°œë°œ í™˜ê²½ì—ì„œë§Œ ë¡œê¹…
const logger = {
  debug: (message: string, data?: any) => {
    if (import.meta.env.DEV) {
      console.log(`[DEBUG] ${message}`, data);
    }
  },
  
  error: (message: string, error?: Error) => {
    if (import.meta.env.DEV) {
      console.error(`[ERROR] ${message}`, error);
    }
  },
};

// âœ… React DevTools ìµœì í™”
const ComponentWithDisplayName: React.FC = () => {
  return <div>ì»´í¬ë„ŒíŠ¸</div>;
};
ComponentWithDisplayName.displayName = 'ComponentWithDisplayName';
```

### ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
```typescript
// âœ… ì„±ëŠ¥ ì¸¡ì • ìœ í‹¸ë¦¬í‹°
const performanceMonitor = {
  startTiming: (label: string) => {
    if (import.meta.env.DEV) {
      performance.mark(`${label}-start`);
    }
  },

  endTiming: (label: string) => {
    if (import.meta.env.DEV) {
      performance.mark(`${label}-end`);
      performance.measure(label, `${label}-start`, `${label}-end`);
      
      const measurement = performance.getEntriesByName(label)[0];
      console.log(`${label}: ${measurement.duration.toFixed(2)}ms`);
    }
  },
};
```

## ğŸ“‹ ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë¹Œë“œ ì „ í™•ì¸ì‚¬í•­
```bash
# 1. ë¦°íŒ… ê²€ì‚¬
npm run lint

# 2. íƒ€ì… ì²´í¬
npx tsc --noEmit

# 3. í…ŒìŠ¤íŠ¸ ì‹¤í–‰
npm run test

# 4. ë¹Œë“œ í…ŒìŠ¤íŠ¸
npm run build

# 5. ë¹Œë“œ ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°
npm run preview
```

### ì„±ëŠ¥ í™•ì¸
- **ë²ˆë“¤ í¬ê¸° ë¶„ì„**: `npm run build`ë¡œ ìƒì„±ëœ íŒŒì¼ í¬ê¸° í™•ì¸
- **ë¼ì´íŠ¸í•˜ìš°ìŠ¤ ìŠ¤ì½”ì–´**: 90ì  ì´ìƒ ëª©í‘œ
- **Core Web Vitals**: LCP, FID, CLS ì§€í‘œ í™•ì¸

### ë³´ì•ˆ í™•ì¸
- **ì˜ì¡´ì„± ì·¨ì•½ì **: `npm audit` ì‹¤í–‰
- **í™˜ê²½ ë³€ìˆ˜**: ë¯¼ê°í•œ ì •ë³´ ë…¸ì¶œ í™•ì¸
- **HTTPS**: í”„ë¡œë•ì…˜ì—ì„œ HTTPS ì‚¬ìš© í™•ì¸

## ğŸš« ë°°í¬ ì‹œ ê¸ˆì§€ì‚¬í•­

### ì ˆëŒ€ í•˜ì§€ ë§ ê²ƒ
- **console.log ì œê±° ì•ˆ í•¨**: í”„ë¡œë•ì…˜ì—ì„œ ë¶ˆí•„ìš”í•œ ë¡œê·¸ ì¶œë ¥
- **ê°œë°œìš© API í‚¤ ì‚¬ìš©**: í”„ë¡œë•ì…˜ìš© í‚¤ë¡œ êµì²´ í•„ìˆ˜
- **Source Map ë…¸ì¶œ**: í”„ë¡œë•ì…˜ì—ì„œ ì†ŒìŠ¤ ë§µ ë¹„í™œì„±í™”
- **ì—ëŸ¬ ìŠ¤íƒ ë…¸ì¶œ**: ì‚¬ìš©ìì—ê²Œ ìƒì„¸ ì—ëŸ¬ ì •ë³´ ë…¸ì¶œ ê¸ˆì§€

### Docker ë¹Œë“œ ì‹œ ì£¼ì˜ì‚¬í•­
```dockerfile
# âœ… Multi-stage ë¹Œë“œ ì‚¬ìš©
FROM node:18-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

FROM node:18-alpine AS runner
WORKDIR /app
COPY --from=builder /app/node_modules ./node_modules
COPY . .
RUN npm run build

# âœ… ì •ì  íŒŒì¼ë§Œ ì œê³µ
FROM nginx:alpine
COPY --from=runner /app/dist /usr/share/nginx/html
```

ì´ ê·œì¹™ë“¤ì„ ì¤€ìˆ˜í•˜ì—¬ ì•ˆì •ì ì´ê³  ì„±ëŠ¥ì´ ìš°ìˆ˜í•œ í”„ë¡ íŠ¸ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•˜ì„¸ìš”!
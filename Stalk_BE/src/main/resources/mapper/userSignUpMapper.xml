<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper

        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"

        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.Stalk.project.api.signup.dao.UserMapper">

    <select id="findByUserId" resultType="com.Stalk.project.api.signup.entity.User">
        SELECT * FROM users WHERE user_id = #{userId}
    </select>

    <select id="findByNickname" resultType="com.Stalk.project.api.signup.entity.User">
        SELECT * FROM users WHERE nickname = #{nickname}
    </select>

    <insert id="insertUser" useGeneratedKeys="true" keyProperty="id"
            parameterType="com.Stalk.project.api.signup.entity.User">
        INSERT INTO users (
            name, user_id, email, password, contact, nickname,
            login_type, role, image, is_verified, terms_agreed, is_active, created_at
        ) VALUES (
                     #{name}, #{userId}, #{email}, #{password}, #{contact}, #{nickname},
                     #{loginType}, #{role}, #{image}, #{isVerified}, #{termsAgreed}, #{isActive}, NOW()
                 )
    </insert>

    <update id="markUserVerified" parameterType="string">
        UPDATE users
        SET is_verified = TRUE,
            updated_at = CURRENT_TIMESTAMP
        WHERE email = #{email}
    </update>

</mapper>
